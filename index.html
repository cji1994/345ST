<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shift Activity Tracker</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
  body { background-color: #0f0f11; color: #e6e6e6; }
  .card { background-color: #1a1c1f; }
  .card-hover:hover { background-color: #24272b; }
  .input-dark { background-color: #2a2d31; border: 1px solid #3a3d42; color: #e6e6e6; }
  .modal-bg { background: rgba(0,0,0,0.7); }
</style>
</head>

<body class="h-screen w-screen overflow-hidden">
<div class="flex h-full">

  <!-- LEFT SIDEBAR -->
  <div class="w-1/3 border-r border-gray-800 p-4 overflow-y-auto">
    <h1 class="text-2xl font-bold mb-4">Entries</h1>

    <!-- FILTERS (Option A) -->
    <div class="mb-4 space-y-2">
      <select id="filterType" class="w-full p-2 rounded input-dark">
        <option value="All">Filter by Type: All</option>
        <option value="Fault">Fault</option>
        <option value="Maintenance">Maintenance</option>
        <option value="Misc">Misc</option>
      </select>

      <select id="filterWatch" class="w-full p-2 rounded input-dark">
        <option value="All">Filter by Watch: All</option>
        <option value="A">Watch A</option>
        <option value="B">Watch B</option>
        <option value="C">Watch C</option>
        <option value="D">Watch D</option>
        <option value="E">Watch E</option>
      </select>
    </div>

    <div id="entryList" class="space-y-2"></div>
  </div>

  <!-- RIGHT PANEL -->
  <div class="w-2/3 p-6 overflow-y-auto" id="rightPanel">
    <!-- This is dynamically swapped between Add Form and Viewing Panel -->
  </div>

</div>

<!-- EDIT MODAL -->
<div id="editModal" class="fixed inset-0 hidden modal-bg flex items-center justify-center">
  <div class="card p-6 rounded-lg w-1/3">
    <h2 class="text-xl font-bold mb-4">Edit Entry</h2>

    <div class="space-y-3">
      <select id="editType" class="w-full p-2 rounded input-dark">
        <option value="Fault">Fault</option>
        <option value="Maintenance">Maintenance</option>
        <option value="Misc">Misc</option>
      </select>

      <select id="editWatch" class="w-full p-2 rounded input-dark">
        <option value="A">Watch A</option>
        <option value="B">Watch B</option>
        <option value="C">Watch C</option>
        <option value="D">Watch D</option>
        <option value="E">Watch E</option>
      </select>

      <input id="editName" class="w-full p-2 rounded input-dark" placeholder="Task Name" />
      <input id="editHolder" class="w-full p-2 rounded input-dark" placeholder="Task Owner" />
      <input id="editDate" type="date" class="w-full p-2 rounded input-dark" />
      <input id="editTime" type="time" class="w-full p-2 rounded input-dark" />
      <textarea id="editComments" class="w-full p-2 rounded input-dark h-28"></textarea>
    </div>

    <div class="flex justify-end space-x-3 mt-4">
      <button onclick="closeEditModal()" class="px-4 py-2 bg-gray-600 rounded">Cancel</button>
      <button onclick="saveEdit()" class="px-4 py-2 bg-blue-600 rounded">Save</button>
    </div>
  </div>
</div>

<script>
/* -----------------------------
    STORAGE & GLOBALS
------------------------------*/
let entries = JSON.parse(localStorage.getItem("entries") || "[]");
let selectedEntry = null;
let editingIndex = null;

/* -----------------------------
    RENDER LEFT SIDEBAR LIST
------------------------------*/
function renderList() {
  const typeFilter = document.getElementById("filterType").value;
  const watchFilter = document.getElementById("filterWatch").value;

  const list = document.getElementById("entryList");
  list.innerHTML = "";

  entries.forEach((entry, index) => {
    if ((typeFilter === "All" || entry.type === typeFilter) &&
        (watchFilter === "All" || entry.watch === watchFilter)) {

      const div = document.createElement("div");
      div.className = "card p-3 rounded cursor-pointer card-hover";
      div.innerHTML = `
        <div class="font-semibold">${entry.name}</div>
        <div class="text-sm opacity-70">${entry.date} ${entry.time}</div>
      `;
      div.onclick = () => viewEntry(index);
      list.appendChild(div);
    }
  });
}

/* -----------------------------
    RIGHT PANEL: ADD FORM
------------------------------*/
function showAddForm() {
  document.getElementById("rightPanel").innerHTML = `
    <h1 class="text-xl font-bold mb-4">Add New Entry</h1>
    <div class="space-y-3">
      <select id="newType" class="w-full p-2 rounded input-dark">
        <option value="Fault">Fault</option>
        <option value="Maintenance">Maintenance</option>
        <option value="Misc">Misc</option>
      </select>

      <select id="newWatch" class="w-full p-2 rounded input-dark">
        <option value="A">Watch A</option>
        <option value="B">Watch B</option>
        <option value="C">Watch C</option>
        <option value="D">Watch D</option>
        <option value="E">Watch E</option>
      </select>

      <input id="newName" class="w-full p-2 rounded input-dark" placeholder="Task Name" />
      <input id="newHolder" class="w-full p-2 rounded input-dark" placeholder="Task Owner" />
      <input id="newDate" type="date" class="w-full p-2 rounded input-dark" />
      <input id="newTime" type="time" class="w-full p-2 rounded input-dark" />
      <textarea id="newComments" class="w-full p-2 rounded input-dark h-28"></textarea>

      <button onclick="addEntry()" class="w-full bg-green-600 p-2 rounded">Add Entry</button>
    </div>
  `;
}

/* -----------------------------
    ADD ENTRY
------------------------------*/
function addEntry() {
  const entry = {
    type: document.getElementById("newType").value,
    watch: document.getElementById("newWatch").value,
    name: document.getElementById("newName").value,
    holder: document.getElementById("newHolder").value,
    date: document.getElementById("newDate").value,
    time: document.getElementById("newTime").value,
    comments: document.getElementById("newComments").value
  };

  entries.push(entry);
  localStorage.setItem("entries", JSON.stringify(entries));
  renderList();
  showAddForm();
}

/* -----------------------------
    VIEW ENTRY (right panel)
------------------------------*/
function viewEntry(index) {
  selectedEntry = entries[index];

  document.getElementById("rightPanel").innerHTML = `
    <h1 class="text-2xl font-bold mb-4">${selectedEntry.name}</h1>

    <div class="space-y-2 text-lg">
      <div><strong>Type:</strong> ${selectedEntry.type}</div>
      <div><strong>Watch:</strong> ${selectedEntry.watch}</div>
      <div><strong>Owner:</strong> ${selectedEntry.holder}</div>
      <div><strong>Date:</strong> ${selectedEntry.date}</div>
      <div><strong>Time:</strong> ${selectedEntry.time}</div>

      <div class="mt-4"><strong>Comments:</strong><br/>${selectedEntry.comments}</div>
    </div>

    <div class="flex space-x-3 mt-6">
      <button onclick="openEditModal(${index})" class="px-4 py-2 bg-blue-600 rounded">Edit</button>
      <button onclick="deleteEntry(${index})" class="px-4 py-2 bg-red-600 rounded">Delete</button>
      <button onclick="showAddForm()" class="px-4 py-2 bg-gray-700 rounded">Back</button>
    </div>
  `;
}

/* -----------------------------
    DELETE ENTRY
------------------------------*/
function deleteEntry(index) {
  if (!confirm("Delete this entry?")) return;

  entries.splice(index, 1);
  localStorage.setItem("entries", JSON.stringify(entries));

  renderList();
  showAddForm();
}

/* -----------------------------
    EDIT MODAL
------------------------------*/
function openEditModal(index) {
  editingIndex = index;
  const e = entries[index];

  document.getElementById("editType").value = e.type;
  document.getElementById("editWatch").value = e.watch;
  document.getElementById("editName").value = e.name;
  document.getElementById("editHolder").value = e.holder;
  document.getElementById("editDate").value = e.date;
  document.getElementById("editTime").value = e.time;
  document.getElementById("editComments").value = e.comments;

  document.getElementById("editModal").classList.remove("hidden");
}

function closeEditModal() {
  document.getElementById("editModal").classList.add("hidden");
}

function saveEdit() {
  const e = entries[editingIndex];

  e.type = document.getElementById("editType").value;
  e.watch = document.getElementById("editWatch").value;
  e.name = document.getElementById("editName").value;
  e.holder = document.getElementById("editHolder").value;
  e.date = document.getElementById("editDate").value;
  e.time = document.getElementById("editTime").value;
  e.comments = document.getElementById("editComments").value;

  localStorage.setItem("entries", JSON.stringify(entries));

  closeEditModal();
  renderList();
  viewEntry(editingIndex);
}

/* INIT */
showAddForm();
renderList();
</script>

</body>
</html>
